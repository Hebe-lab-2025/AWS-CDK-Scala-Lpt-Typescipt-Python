å¾ˆå¥½ï¼Œè¿™é‡Œä½ é—®çš„æ˜¯ **IAM / S3 é‡Œä¸€ä¸ªæœ€æ ¸å¿ƒã€ä¹Ÿæœ€å®¹æ˜“è¢«è¯¯è§£çš„æ¦‚å¿µï¼š`Principal`**ã€‚æˆ‘ç›´æ¥ç»™ä½ **å®šæ­»å«ä¹‰ + å¯¹æ¯”ä¾‹å­ + é£é™©ç‚¹**ã€‚

---

## âœ… ä¸€å¥è¯å®šä¹‰ï¼ˆå¿…é¡»è®°ä½ï¼‰

> **Principal = è°ï¼ˆwhoï¼‰è¢«å…è®¸æˆ–è¢«æ‹’ç»è®¿é—®è¿™ä¸ªèµ„æº**

ä¹Ÿå°±æ˜¯ï¼š
ğŸ‘‰ **è¿™ä¸ªç­–ç•¥æ˜¯â€œç»™è°ç”¨çš„â€**

---

## ğŸ§  æ”¾è¿›ä½ è¿™æ®µ Policy é‡Œç¿»è¯‘ï¼ˆäººè¯ç‰ˆï¼‰

```json
"Principal": "*"
```

æ„æ€æ˜¯ï¼š

> **ä»»ä½•äºº**ï¼ˆä»»ä½• AWS è´¦å·ã€ä»»ä½• IAM ç”¨æˆ·ã€è§’è‰²ã€åŒ¿åç”¨æˆ·ï¼‰

---

## ğŸ” ä½ çš„è¿™æ¡ S3 Policy å®Œæ•´ç¿»è¯‘

```json
{
  "Effect": "Allow",
  "Principal": "*",
  "Action": "s3:GetObject",
  "Resource": "<ARN>/*"
}
```

ğŸ‘‰ äººè¯ï¼š

> **å…è®¸ä»»ä½•äººï¼Œä»è¿™ä¸ª bucket é‡Œè¯»å–å¯¹è±¡ï¼ˆGETï¼‰**

âš ï¸ è¿™ç­‰ä»·äºï¼š

> **å…¬å…±å¯è¯»ï¼ˆPublic Readï¼‰Bucket**

---

## ğŸ“¦ Principal å¸¸è§å–å€¼ï¼ˆä½ ä¸€å®šä¼šé‡åˆ°ï¼‰

### 1ï¸âƒ£ `Principal: "*"`

```json
"Principal": "*"
```

* æ‰€æœ‰äºº
* åŒ…æ‹¬åŒ¿åå…¬ç½‘ç”¨æˆ·
* âš ï¸ **æœ€å±é™©**

---

### 2ï¸âƒ£ æŒ‡å®š AWS è´¦å·

```json
"Principal": {
  "AWS": "arn:aws:iam::123456789012:root"
}
```

* åªå…è®¸è¿™ä¸ªè´¦å·

---

### 3ï¸âƒ£ æŒ‡å®š IAM Roleï¼ˆæœ€å¸¸è§ï¼‰

```json
"Principal": {
  "AWS": "arn:aws:iam::123456789012:role/AccessBucketRole"
}
```

* åªå…è®¸ EC2 / Lambda ç”¨è¿™ä¸ªè§’è‰²è®¿é—®

âœ… **ç”Ÿäº§ç¯å¢ƒæ¨è**

---

### 4ï¸âƒ£ æŒ‡å®šæœåŠ¡ï¼ˆService Principalï¼‰

```json
"Principal": {
  "Service": "lambda.amazonaws.com"
}
```

* å…è®¸ AWS æœåŠ¡è®¿é—®

---

## ğŸ§  å’Œ IAM Policy çš„å…³é”®åŒºåˆ«ï¼ˆé¢è¯•å¿…è€ƒï¼‰

| å¯¹æ¯”é¡¹           | IAM Policy    | S3 Bucket Policy |
| ------------- | ------------- | ---------------- |
| å†™ Principal å— | âŒ ä¸å†™          | âœ… å¿…é¡»             |
| ç­–ç•¥é™„ç€ç‚¹         | èº«ä»½ï¼ˆUser/Roleï¼‰ | èµ„æºï¼ˆBucketï¼‰       |
| ä½œç”¨            | æˆ‘èƒ½å¹²å•¥          | è°èƒ½è®¿é—®æˆ‘            |

å£è¯€ï¼š

> **IAM Policyï¼šæˆ‘æ˜¯è°ï¼Œæˆ‘èƒ½å¹²å•¥**
> **Resource Policyï¼šè°èƒ½è®¿é—®æˆ‘**

---

## âš ï¸ ä½ è¿™æ¡ç­–ç•¥çš„å®‰å…¨å«ä¹‰ï¼ˆä¸€å®šè¦æ‡‚ï¼‰

```json
"Principal": "*"
```

æ„å‘³ç€ï¼š

* å…¬ç½‘å¯è®¿é—®
* æµè§ˆå™¨ç›´æ¥è®¿é—®å¯¹è±¡ URL
* éå¸¸é€‚åˆï¼š

  * é™æ€ç½‘ç«™
  * Lab å®éªŒ

âŒ **ä¸é€‚åˆç”Ÿäº§ç§æœ‰æ•°æ®**

---

## ğŸ¯ é¢è¯•ä¸€å¥è¯æ¨¡æ¿ï¼ˆç›´æ¥ç”¨ï¼‰

> *Principal defines the entity that is allowed or denied access to the AWS resource.*

---

## ğŸ”¥ å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥é©¬ä¸Šå¸®ä½ åšä¸‰ä»¶äº‹ä¹‹ä¸€ï¼š

1. ğŸ” æŠŠ `Principal: "*"` æ”¹æˆ **åªå…è®¸ EC2 / Lambda**
2. ğŸ§ª ç”»ä¸€å¼  **IAM Policy vs Bucket Policy** å¯¹æ¯”å›¾
3. ğŸ§  ç»™ä½ ä¸€ç»„ **S3 Public Access Block å¸¸è§å‘é¢˜**

ä½ é€‰ä¸€ä¸ªï¼Œæˆ‘ç»§ç»­ã€‚
